((e,t)=>{'object'==typeof exports&&'undefined'!=typeof module?t(exports,require('react'),require('effector')):'function'==typeof define&&define.amd?define(['exports','react','effector'],t):t((e='undefined'!=typeof globalThis?globalThis:e||self).effectorReact={},e.React,e.effector)})(this,((e,t,effector)=>{function n(e){return e&&'object'==typeof e&&'default'in e?e:{default:e}}function r(e){effector.is.store(e)||i('expect useStore argument to be a store');let t=l.default.useRef(e),n=l.default.useState(e.getState())[1];return c((()=>(t.current===e&&n(e.getState()),t.current=e,e.updates.watch(n))),[e]),e.getState()}function o({store:e,keys:t,fn:n}){effector.is.store(e)||i('useStoreMap expects a store'),Array.isArray(t)||i('useStoreMap expects an array as keys'),'function'!=typeof n&&i('useStoreMap expects a function');let o=l.default.useMemo((()=>effector.createStore(n(e.getState(),t)).on(e,((e,r)=>n(r,t)))),t),a=r(o);return c((()=>()=>{o.off(e),effector.clearNode(o,{deep:1})}),t),a}function a(e,t){return t.displayName=e,t}function u(e,t){function n(e){let n=l.default.useRef(e),a=r(o);c((()=>(s({props:n.current,state:o.getState()}),()=>{f({props:n.current,state:o.getState()})})),[]);let u=t(e,a);return n.current=e,u}let o;effector.is.store(e)?o=e:'object'==typeof e&&null!==e?o=effector.combine(e):i('shape should be a store or object with stores');let u='Unknown';o&&o.shortName&&(u=o.shortName);let s=effector.createEvent(),f=effector.createEvent();return n.mounted=s,n.unmounted=f,a(u+".View",n)}function s(e,t){return a(`Connect(${t.displayName||t.name||'Unknown'})`,(n=>l.default.createElement(t,Object.assign({},n,r(e)))))}function f(e,t={}){let n=l.default.useRef(null);c((()=>(e.open(n.current),()=>e.close(n.current))),[e]),((e,t)=>{if(e===t)return 1;if('object'==typeof e&&null!==e&&'object'==typeof t&&null!==t){let n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return 0;for(let r=0;r<n.length;r++){let o=n[r];if(e[o]!==t[o])return 0}return 1}return 0})(n.current,t)||(n.current=t,e.set(t))}var l=n(t);let c='undefined'!=typeof window?l.default.useLayoutEffect:l.default.useEffect,i=e=>{throw Error(e)};e.connect=e=>t=>{let n=e;return'function'!=typeof e&&(n=t,t=e),s(t,n)},e.createComponent=u,e.createContextComponent=(e,t,n)=>a((e.shortName||'Unknown')+".ContextComponent",(o=>{let a=l.default.useContext(t),u=r(e);return n(o,u,a)})),e.createGate=(e="gate",t={})=>{let n;return'object'==typeof e&&null!==e&&('defaultState'in e&&(t=e.defaultState),e.domain&&(n=e.domain),e=e.name),(({name:e="gate",domain:t,defaultState:n,hook:r})=>{function o(e){return r(o,e),null}let u=effector.createEvent(),s=effector.createEvent(),f=effector.createEvent(),l=effector.createStore(Boolean(0),{named:'status'}).on(s,(()=>Boolean(1))).on(f,(()=>Boolean(0))),c=effector.createStore(n,{named:'state'}).on(u,((e,t)=>t)).reset(f);if(t){let{hooks:e}=t;effector.launch({target:[e.store,e.store,e.event,e.event,e.event],params:[l,c,s,f,u]})}return o.open=s,o.close=f,o.status=l,o.state=c,o.set=u,a("Gate:"+e,o)})({name:e,domain:n,defaultState:t,hook:f})},e.createReactState=s,e.createStoreConsumer=e=>u(e,(({children:e},t)=>e(t))),e.useEvent=e=>e,e.useGate=f,e.useList=(e,t)=>{let n,r=[];'object'==typeof t&&null!==t?(t.keys&&(r=t.keys),n=t.fn):n=t,effector.is.store(e)||i('expect useList first argument to be a store'),'function'!=typeof n&&i("expect useList's renderItem to be a function"),Array.isArray(r)||i("expect useList's keys to be an array");let u=l.default.useMemo((()=>{let t=a((e.shortName||'Unknown')+".Item",(({index:t,keys:n})=>{let r=o({store:e,keys:[t,...n],fn:(e,t)=>e[t[0]]});return f.current(r,t)}));return l.default.memo(t)}),[e]),s=o({store:e,keys:[e],fn:e=>e.length}),f=l.default.useRef(n);f.current=n;let c=l.default.useMemo((()=>r),r);return Array.from({length:s},((e,t)=>l.default.createElement(u,{index:t,key:t,keys:c})))},e.useStore=r,e.useStoreMap=o,Object.defineProperty(e,'__esModule',{value:1})}));
//# sourceMappingURL=effector-react.umd.js.map
